#################################
# Events for the Albigensian Heresy
#
# made for the Beyond Typus addon "Heresy!"
#
# by neothiamin
#################################

namespace = dh_albi

#Albigensian Resurgence

province_event = {
	id = dh_albi.1
	title = dh_albi.1.t
	desc = dh_albi.1.desc
	picture = PRAYING_eventPicture

	fire_only_once = yes

	trigger = {
		dh_albi_spawn_area = yes
		religion = catholic
		has_global_flag = dh_cathar_religion_enabled
	}	

	mean_time_to_happen = {
		months = 60
	}

	major = yes

	#Not again...
	option = {
		name = dh_albi.1.a
		enable_religion = cathar
		change_religion = cathar
		#add_permanent_province_modifier = {
		#	name = religious_center
		#	duration = -1
		#}
		add_reform_center = cathar
	}
}

#Albigensian Center

province_event = {	
	id = dh_albi.2
	title = dh_albi.2.t
	desc = dh_albi.2.desc
	picture = PRAYING_eventPicture
	
	trigger = {
		had_global_flag = {
			flag = dh_cathar_religion_enabled
			days = 730
		}
		is_religion_enabled = cathar
		religion = catholic
		OR = {
			area = north_rhine_area
			area = lower_rhineland_area
			area = westphalia_area
			#area = muenster_area
			#area = palatinate_area
			#region = south_german_region
			region = france_region
			#region = italy_region
			region = low_countries_region
		}
		development = 20
		num_of_centers_of_reformation = {
			religion = cathar
			count = 1
		}
		dh_crazy_mode_cor = {
			RELIGION = cathar
			COUNT1 = 7
			COUNT2 = 3
		}
	}
	
	mean_time_to_happen = {
		years = 15
		modifier = {
			factor = 0.5
			has_global_flag = dh_crazy_mode
		}
		modifier = {
			factor = 0.33
			area = west_languedoc_area
		}
		modifier = {
			factor = 0.8
			dh_albi_spawn_area = yes
		}
		modifier = {
			factor = 1.25
			OR = {
				region = north_german_region
				region = south_german_region
			}
		}
		modifier = {
			factor = 1.5
			region = iberia_region
		}
	}

	#Blast!
	option = {
		name = dh_albi.2.a
		change_religion = cathar
		add_reform_center = cathar
	}
}

#Mass Conversion in Toulouse
country_event = {
	id = dh_albi.3
	title = dh_albi.3.t
	desc = dh_albi.3.desc
	picture = ANGRY_MOB_eventPicture

	fire_only_once = yes
	
	trigger = {
		tag = FRA
		religion = catholic
		is_religion_enabled = cathar
		had_global_flag = {
			flag = dh_cathar_religion_enabled
			days = 1825
		}
	}

	mean_time_to_happen = {
		years = 25
	}

	major = yes

	#No!
	option = {
		name = dh_albi.3.a
		custom_tooltip = dh_mass_conversions_in_toulouse.tt
		hidden_effect = {
			every_owned_province = {
				limit = {
					dh_toulouse_albi = yes
					religion = catholic
				}
				random = {
					chance = 75
					change_religion = cathar
				}			
			}
			random_list = {
				50 = {
					7904 = {
						change_religion = cathar
						add_reform_center = cathar
					}
				}
				50 = {
					196 = {
						change_religion = cathar
						add_reform_center = cathar
					}
				}
			}
		}
	}

}